# Введение. Термины и понятия \(тезисно\)

Принципиально существует два вида цифровых карт: **растровые** и **векторные**.

**Растровые карты** - это картинка. При увеличении такой карты не появляются дополнительные детали, а увеличиваются в размере составляющие картинку пиксели. Спутниковые фотографии - одна из разновидностей растровых карт.

**Векторные карты**. В противоположность растровым, векторными называют карты, которые представляют из себя не готовую картинку, а содержат непосредственно информацию о домах, улицах и перекрёстках, которую потом можно превратить в готовую для просмотра карту. При укрупнении векторной карты появляются дополнительные подробности.

Программы для просмотра векторных карт намного сложнее в технической реализации, но зато предоставляют больше возможностей. Просматриваемую карту можно на лету менять под конкретные нужды, убирая с неё мешающие элементы и добавляя нужные. Кроме того, хранящаяся в векторном виде карта получается гораздо компактнее, в десятки, а то и сотни раз, а это актуально если мы хотим хранить в смартфоне или планшете много карт, а память устройства ограничена небольшим объёмом.

**Рендер**. Вопреки ожиданию, большинство векторных карт \(типа OSM, яндекс- или гугло-карт\) просматривается пользователями в интернете не напрямую, а после того, как эту векторную карту преобразуют в растровую. Отрисовку изменившегося участка векторной карты выгоднее провести на сервере один раз, а потом показывать полученный рисунок сотням разных пользователей, которые будут просматривать этот фрагмент. Процесс преобразования векторной карты в растровую называется рендер.

**TMS \(Tile Map Service\)** - формат хранения растровых карт онлайн, позволяет подгружать и просматривать только нужный участок карты. Растровые карты традиционно хранятся в виде мозаики "тайлов" - картинок размером 256х256 пикселей, содержащих в себе кусочки общей карты. Leaflet - это стандарт, который однозначно сопоставляет между собой координаты на карте и номер нужного тайла. Если выложенные в интернет тайлы именуются по стандарту leaflet - их может скачивать и просматривать любая leaflet-совместимая программа или сайт. OSM, яндекс-карты, яндекс-панорамы, космоснимки и десятки других сайтов используют именно leaflet-тайлы. У Google используется свой, не совместимый с ними формат адресации \(хотя в целом используется такая же система тайлов\).

**GPX** - это наиболее распространённый формат, позволяющий хранить, записывать и просматривать пройденные треки и запланированные маршруты. Если внутри трека хранятся не только точки на карте, но и время их прохождения - это трек. Если данных о времени нет - это маршрут.

**"Карты генштаба"** - советские военные топографические карты 50-х - 80-х годов выпуска. Несмотря на давность выпуска, являются на сегодня одними из лучших туристических карт на различные малонаселённые регионы. Широко доступны в интернете в виде отсканированных листов на разные регионы. Кроме того, энтузиастами уже давно выполнена обрезка и привязка этих сканов к координатам, а так же нарезка полученного результата в формате Leaflet. Поэтому с "картами генштаба" сегодня можно работать так же, как с любыми другими растровыми цифровыми картами. Карты масштаба "километровка" \(1см=1км\) доступны практически на любой регион, от Австралии до Канады. Многие регионы имеют фрагментарное покрытие более подробными "пятисотметровками" \(1см=500м\). Наиболее подробные "двухсотпятидесятиметровки" \(1см=250м\) встречаются в исключительных случаях и только на отдельные регионы. По степени подробности отрисовки рельефа \(оврагов, ущелий и т.п.\), "карты генштаба" далеко опережают любые современные цифровые карты, построенные на основе данных SRTM или ASTER DEM.

**SRTM** и **ASTER DEM** - цифровая информация о высотах местности над уровнем моря. Почти все современные цифровые карты показывают данные о рельефе гор и холмов на основании этих баз. Данные о высотах были измерены с орбиты, в автоматическом режиме.

**OpenStreetMap \(OSM\)** - коллективный проект общедоступно рисующейся карты мира. Подобно тому, как статьи википедии пишут обычные люди, карту OSM рисуют обычные люди. Плюсы: в населённых регионах карта очень подробна, вплоть до калиток и тропинок. Минусы: в малонаселённой сельской местности карта может ограничиваться шоссе и лесными массивами.

**Wikimapia** - старинный проект для маркировки и надписывания объектов на спутниковой карте Google. Статьи, описывающие отмеченные на карте объекты, могут включать в себя загруженные пользователями фотографии и описание, сделанное местными жителями. Карта и комментарии не очень модерируются, но часто именно это делает викимапию бесценным источником сведений, которые не найти больше нигде. Мосты, закрытые зоны, достопримечательности, магазины, заводы и т.п.

**OSMand** - приложение для телефонов и планшетов Android и Apple. Умеет напрямую и без использования интернета работать с векторными картами OSM. Показывает изолинии и отрисовывает форму рельефа. Имеет несколько разных стилей отрисовки данных OSM, в т.ч. один, стилизованный под "карты Генштаба". Может показывать тип дорожного покрытия \(если эта информация есть в базе OSM\). Умеет без интернета показывать растровые карты, изготовленные при помощи программы SAS Planet. Умеет записывать GPX-треки и показывать GPX-маршруты. Умеет гибко работать с POI \(показывать выбранные категории объектов POI, добавлять на карту новые объекты POI\). Умеет создавать GPX-маршруты с автопрокладкой \(автопрокладка работает чуть менее гибко, чем у GPSies\). Умеет работать в режиме голосового навигатора, в т.ч. умеет вести голосом по заранее подготовленному GPX-маршруту. При наличии интернет-подключения может подгружать и показывать карты в формате Leaflet и так же показывать панорамы Mapillary.

nakarte.me - сайт для работы с растровыми leaflet-картами и GPX-треками. Позволяет просматривать растровые карты, быстро переключаясь с одной на другую для многостороннего анализа возможных препятствий на выбранном маршруте. Отрисовывает поверх карты GPX-треки и маршруты. Позволяет рисовать собственные маршруты \(без автопрокладки, каждая точка маршрута рисуется вручную\) и потом скачивать созданные маршруты в формате GPX к себе на компьютер. Позволяет просматривать тепловые карты Strava на произвольной подложке и с привязкой к GPX-трекам. Умеет показывать гуглопанорамы и панорамы с сайта Mapillary, а так же объекты карты Wikimapia и их описание \(включая фотографии объектов\). Имеет встроенный список на два десятка различных карт, но главное, что кроме заранее заданных можно добавлять в список слоёв любые произвольные leaflet-совместимые онлайн-карты.

**Mapillary** - сервис панорам дорог и улиц. Отличается от Google- и Яндекс-панорам тем, что привязанные к gps-координатам серии фотографий на этот сайт загружают сами пользователи. Благодаря этой особенности, на сервисе можно увидеть панорамы небольших дорог или даже троп, куда не забираются гугломобили. Сам по себе сервис дубоват и тяжёл в использовании, но с загруженными на него фотографиями удобно работать через сайт nakarte.me. Есть смысл использовать этот сервис в обе стороны: как для анализа маршрутов, так и для загрузки технических фото из походов.

**SAS Planet** - программа под Windows. Предназначена для работы с цифровыми растровыми картами. Принимает десятки форматов на входе, экспортирует в десятки форматов на выходе. Работает с различными форматами хранения растровых карт на диске \(можно скачивать карты единым файлом, а потом открывать эти файлы в программе\). В рамках данного курса нас будут интересовать возможность загрузки растровых карт в формате Leaflet на выбранный регион, затем экспорт выбранного участка карты в форматы для приложения OSMand или навигатора Garmin. Программа имеет десятки заранее настроенных пресетов для скачивания различных растровых карт в формате Leaflet, но можно добавлять к ним свои.

**Garmin** - линейка признанных спутниковых навигаторов мирового класса. Водозащитные, ударопрочные, достаточно экономные, питание от нескольких батареек AA. Умеют записывать GPX-трек и показывать на экране GPX-маршрут. Расход батарей и качество картинки на экране сильно зависят от модели. Умеют показывать загруженные в них растровые и векторные карты \(векторные - в своём собственном формате, но есть конвертер векторных карт OSM в векторные карты Garmin\).

